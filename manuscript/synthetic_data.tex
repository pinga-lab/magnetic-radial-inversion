\section{Application to synthetic data}

\subsection{Simple model test}

We have simulated a funnel-shaped source with simple geometry (blue prisms in Figs \ref{fig:kimb_model}b and \ref{fig:kimb_results}), which extends from $z_0=0$ m to $1600$ m along depth and satisfies most of the constraints described in subsection \ref{sec:constraints}. It is formed by $L=8$ prisms, all of them with the same number of vertices $ V = 20 $, depth extent $ dz = 200 $ m and horizontal coordinates $ (x_0^k, y_0^k) = (0, 0) $ m of the origins $O^k$, $k=1,\dots,L$. The radii of all vertices are equal to each other within the same prism and decrease linearly with depth, varying from $r_j^0=1920$ m, at the shallowest prism, $r_j^L=800$ m, at the deepest prism, $j=1,\dots, V$. All prisms have the same total-magnetization direction with inclination $ -21.5^\circ $, declination $ -18.7^\circ $ and intensity $ m_0 = 9 $ A/m. We calculated the total-field anomaly produced by this simple source on an $ 100 $ km$^2$ area, simulating an airborne survey composed of $ 21 $ flight lines that are equally spaced $ 500 $ m apart along the y axis, at a constant vertical coordinate $ z = -150 $ m. At each line, there are $ 100 $ observation points spaced $101$ m apart along $ x $ axis. The total-field anomaly is corrupted with a pseudo-random Gaussian noise having mean and standard deviation equal to $ 0 $ nT and $ 5 $ nT, respectively (Fig. \ref{fig:kimb_model}a).

We have inverted the synthetic total-field anomaly (Fig. \ref{fig:kimb_model}a) produced by the simple source and obtained 36 different models. Each model was obtained by using a different pair of depth to the top $ z_0 $ and total-magnetization intensity $ m_0 $ (Fig. \ref{fig:kimb_map}). All models were generated by using the true values of total-magnetization inclination and declination, the same interpretation model formed by $ L = 5 $ prisms, each one with $ V = 20 $ vertices, and the same weights for the constraining functions: $\tilde{\alpha}_1 = 10^{-4}$, $\tilde{\alpha}_2 = 10^{-4}$, $\tilde{\alpha}_3 = 10^{-4}$, $\tilde{\alpha}_4 = 0$, $\tilde{\alpha}_5 = 0$, $\tilde{\alpha}_6 = 10^{-6}$, and $\tilde{\alpha}_7 = 10^{-4}$. The initial approximation for all models have the same constant radii $ r^k_j = 2000 $ m, $ k = 1, \dots, L $, $ j  = 1, \dots, V $, the same depth extent $ dz = 350 $ m and the same origin $(x^k_0, y^k_0) = (0, 0) $ m for all prisms.

Fig. \ref{fig:kimb_map} shows that the estimated model obtained by using the true values for depth to the top $ z_0 $ and total-magnetization intensity $ m_0 $ (represented by the red triangle in Fig. \ref{fig:kimb_map}) produces the lowest value of goal function  $ \Gamma(p) $ (eq. \ref{eq:gamma}). Fig. \ref{fig:kimb_results} shows that this estimated model (red prisms in Figs \ref{fig:kimb_results}c and d) not only fits the noise-corrupted data, but also retrieves the geometry of the true source (blue prisms). The estimated depth extent of each prism is $ dz = 297.65 $ m, which results in a total depth extent ($ 1485$ m) very close to the true one ($ 1600 $ m). These results illustrate the good performance of our method in an ideal case.

\subsection{Complex model test}

The second synthetic source has $L=10$ prisms, each one with $M=30$ vertices, and a total magnetization with $m_0 =12$ A/m. The complex model has both induced and remnant magnetization with inclination $-50$ยบ, and declination $9$ยบ. Its depth to the top is at $z_0=200$ m and its bottom is at $5700$ m. The radii of the vertices ($r_j^k$, $j=1,\dots,M$, $k=1,\dots,L$) forming this synthetic body vary from $240$ to $1540$ m and the horizontal coordinates $x_0$ and $y_0$ of the origins of the polygons $O^k$ vary from $-250$ m and $250$ m to $750$ m and $-750$ m, respectively (Figure \ref{fig:complex_model}b) by an equal step for both of $100$ m. We calculated the synthetic data produced by this body, simulating an airborne survey covering an area of $100$ km$^2$ composed of 18 flight lines that are equally spaced from $-4500$ m to $4500$ m and one tie line located close to $x=0$ m, along with the horizontal coordinate $y$, and with a height of flight shown in Figure \ref{fig:complex_model}a. At each line, there are about 100 observations spaced around $80$ m. We took out the observation points from a real airborne survey.

We used the same strategy applied to simple model to define $z_0$ and $ m_0 $. In this case, we chose ranges that do not include the true values of the source's parameters. Therefore, the best solutions are expected to be $\Gamma$ closer to the true values (red triangle in the map). In Fig. \ref{fig:complex_map}, we show the \ref{eq:gamma} values for the multiple solutions and, also, the red triangle indicates the true pair of $z_0$ and $ m_0 $ and the cyan diamond represents the best pair considering the chosen ranges. As we can see, the lower values of $\Gamma$ are close to the true pair of $z_0$ and $ m_0 $.

For this case, the initial guess is a cylinder formed by $L=8$ prisms, each one with $M=15$ vertices centered at $(x_0^k, y_0^k) = (-300,300)$. All prisms that form the initial approximation have the same $r_i = 800$, $i = 1, \dots, V$, m and depth extent $dz=650$ m (Figure \ref{fig:complex_model}a). We set the weights for the constraints $\tilde{\alpha}_1 = 10^{-4}$, $\tilde{\alpha}_2 = 10^{-4}$, $\tilde{\alpha}_5 = 10^{-4}$, $\tilde{\alpha}_6 = 10^{-7}$, and $\tilde{\alpha}_7 = 10^{-4}$. Again, the third and fourth constraints were not used. Fig. \ref{fig:complex_result}a shows the fitting of the inversion of the noise-corrupted total-field anomaly in Fig. \ref{fig:complex_model}a. The residuals have a mean and a standard deviation very close to the values of the noise also the histogram is coherent with a Gaussian distribution (Figure \ref{fig:complex_result})a. Due to the lower number of prisms in the interpretation model, the estimated body does not retrieve perfectly the simulated body. However, the volume of the complex model is $12.60$ km$^3$, while the volume of the estimated source is $12.81$ km$^3$. Moreover, the estimated depth extent is $6145.12$ m, which is very close to $6000$ m. 