\section{Application to synthetic data}

To examine the performance of our inversion method, we present two applications with total-field anomaly data simulating two different isolated geological sources. The first source is a funnel-shaped model with a simple geometry, which satisfies all of the constraints described in Section \ref{sec:metodo}. The aim is to test the regularization in an ideal case with simple geometry. The second source has a complex geometry, which does not satisfy any constraint. The purpose, here, is to show that the constraints can stabilize the inverse problem in a more realistic case retrieving the geometry of the source with known magnetization using the polygonal prisms.

In both applications, the synthetic total-field anomaly was computed in an irregular grid on plane $z=-150$ m and contaminated with pseudorandom Gaussian noise sequences with mean zero and different standard deviation. In both cases, we considered the main magnetic field with inclination and declination of $50^\circ$ and $-15^\circ$, respectively. However, the simple model has only induced magnetization while the second model has a remnant magnetization specified below.

Although the simulated sources have a different depth to the top, we have considered both known. We also assumed the same magnetization for all prisms of the magnetic sources. On the other hand, the depth extent of the sources was not set in the initial guesses because it is a parameter for the inverse problem. Moreover, we have investigated the influence of the parameters from the initial guess on the solution by varying them and evaluating the effect on the misfit function.

\subsection{Simple model test}

The first synthetic source has $L=8$ prisms, each one with $M = 20$ vertices, and a purely induced magnetization with an intensity of $5$ A/m. Its depth to the top $z_0$ is at $50$ m and the bottom at $1250$ m. The radii of the vertices are equal within the same prism and decrease along with the depth with a step of $60$ m starting with $r_j^k=640$ m, $j=1,\dots, M$ (Figure \ref{fig:kimb}a). The horizontal coordinates $x_0$ and $y_0$ of the origins of the polygons $O^k$ are equal to $(0,0)$ for all prisms. We calculated the synthetic data produced by this source on an area of $16$ km$^2$, simulating an airborne survey composed of $16$ flight lines that are equally spaced from $200$ m to $1200$ m along the horizontal coordinate $y$, at a constant vertical coordinate $z=-100$ m (Figure \ref{fig:kimb}b).

For the inversion, we used an interpretation model formed by $L=6$ prisms, each one with $M=15$ vertices. The prisms forming the initial approximation have the same radii for all vertices ($500$ m) and depth extent ($220$ m), so the maximum depth is equal to $1320$ m. We have used all constraints described in Section 2 except the third and fourth constraints. We weighted the constraints with $\alpha_1 = 0.0006$, $\alpha_2 = 0.0006$, $\alpha_5 = 0.009$, $\alpha_6 = 0.00001$, and $\alpha_7 = 0.0001$. Both Cartesian coordinates $x_0^k$ and $y_0^k$ of the origins of all prisms $O^k$, $k=1,\dots,L$, are located at the point $(0,0)$. Fig. \ref{fig:kimb}c shows the result of the inversion of the noise-corrupted total-field anomaly in Fig. \ref{fig:kimb}b. The red prisms are very close to the edges of the true body (blue lines) even using fewer prisms than the true body has. Moreover, the estimated depth extent of each prism is $dz = 200.65$ m, which gives us a very accurate total depth extent of $1203.88$ m. Figure \ref{fig:kimb}d shows that the residuals have a mean mean very close to zero ($\mu=0.09$ nT) and a coherent standard deviation ($\sigma=5.23$ nT).



\subsection{Complex model test}

The second synthetic source has $L=10$ prisms, each one with $M=30$ vertices, and a total magnetization with intensity $\|\mathbf{m}\| =10$ A/m. The complex model has both induced and remnant magnetization with inclination $65$ยบ, and declination $-40.5$ยบ. Its depth to the top $z_0$ is $200$ m and its bottom is at $4200$ m. The radii of the vertices ($r_j^k$, $j=1,\dots,M$, $k=1,\dots,L$) forming this synthetic body vary from $240$ to $1540$ m and the horizontal coordinates $x_0$ and $y_0$ of the origins of the polygons $O^k$ vary from $-250$ m and $250$ m to $750$ m and $-750$ m, respectively (Figure \ref{fig:complex_model}a) by an equal step for both of $100$ m. We calculated the synthetic data produced by this body, simulating an airborne survey covering an area of $100$ km$^2$ composed of 21 flight lines that are equally spaced from $-5000$ m to $5000$ m, along with the horizontal coordinate $y$, and with a height of $-100$ m (Figure \ref{fig:complex_model}b). The initial guess is a cylinder formed by $L=8$ prisms, each one with $M=15$ vertices centered at $(x_0^k, y_0^k) = (0,0)$. All prisms that form the initial approximation have the same radii ($500$ m) and depth extent ($600$ m) reaching $4800$ m of maximum depth(Figure \ref{fig:complex_model}a).

We set the weights for the constraints $\alpha_1 = 0.0005$, $\alpha_2 = 0.003$, $\alpha_5 = 0.05$, $\alpha_6 = 0.00001$, and $\alpha_7 = 0.04$. Again, the third and fourth constraints were not used. Fig. \ref{fig:complex_result}a shows the result of the inversion of the noise-corrupted total-field anomaly in Fig. \ref{fig:complex_model}. Due to the lower number of prisms in the interpretation model, the estimated body does not retrieve perfectly the simulated body. However, the volume of the complex model is $8.40$ km$^3$, while the volume of the estimated source is $8.29$ km$^3$. Moreover, the estimated depth extent is $3875.4$ m, which is close to $4000$ m. The residuals have a mean and a standard deviation very close to the values of the noise also the histogram is coherent with a Gaussian distribution (Figure \ref{fig:complex_result})d.


%In both tests, from the initial guesses (red prisms in Figures 4a e 5a), the method provided estimates that fit the data and retrieve the geometry of the simulated bodies (red prisms in Figures 4b and 5b). Overall, the method can closely estimate the geometries of the simulated bodies and their bottom depths. The acceptable data fittings yielded by the estimated bodies are confirmed by the small residuals shown in Figures 4c and 5c. In both tests, the residuals are smaller than  $\pm 0.34$ nT and $\pm 18$ nT which correspond to less than $1\%$ of the total amplitude of their data sets.