\section{Application to synthetic data}\label{sec:synthetic}

\subsection{Simple model test}

We have simulated a funnel-shaped source with simple geometry (blue prisms in Figs \ref{fig:simple_model}b and \ref{fig:simple_results}), which extends from $z_0=0$ m to $1600$ m along depth and satisfies most of the constraints described in subsection \ref{sec:constraints}. It is formed by $L=8$ prisms, all of them with the same number of vertices $ V = 20 $, thickness $ dz = 200 $ m and horizontal coordinates $ (x_0^k, y_0^k) = (0, 0) $ m of the origins $O^k$, $k=1,\dots,L$. The radii of all vertices are equal to each other within the same prism and decrease linearly with depth, varying from $r_j^0=1920$ m, at the shallowest prism, $r_j^L=800$ m, at the deepest prism, $j=1,\dots, V$. All prisms have the same total-magnetization direction with inclination $ -21.5^\circ $, declination $ -18.7^\circ $ and intensity $ m_0 = 9 $ A/m. We calculated the total-field anomaly produced by this simple model on an $ 100 $ km$^2$ area, simulating an airborne survey composed of $ 21 $ flight lines that are equally spaced $ 500 $ m apart along the y axis, at a constant vertical coordinate $ z = -150 $ m. At each line, there are $ 100 $ observation points spaced $101$ m apart along $ x $ axis. The total-field anomaly is corrupted with a pseudorandom Gaussian noise having mean $ \mu_0=0 $ nT and and standard deviation $ \sigma_0=5 $ nT (Fig. \ref{fig:simple_model}a).

We have inverted the synthetic total-field anomaly (Fig. \ref{fig:simple_model}a) produced by the simple model and obtained 36 different models. Each model was obtained by using a different pair of depth to the top $ z_0 $ and total-magnetization intensity $ m_0 $ (Fig. \ref{fig:simple_map}). All models were generated by using the true values of total-magnetization inclination and declination, the same interpretation model formed by $ L = 5 $ prisms, each one with $ V = 20 $ vertices, and the same weights for the constraining functions: $\tilde{\alpha}_1 = 10^{-5}$, $\tilde{\alpha}_2 = 10^{-4}$, $\tilde{\alpha}_3 = 10^{-4}$, $\tilde{\alpha}_4 = 0$, $\tilde{\alpha}_5 = 0$, $\tilde{\alpha}_6 = 10^{-7}$, and $\tilde{\alpha}_7 = 10^{-6}$. The initial approximation for all models have the same constant radii $ r^k_j = 2000 $ m, $ k = 1, \dots, L $, $ j  = 1, \dots, V $, the same thickness $ dz = 350 $ m and the same origin $(x^k_0, y^k_0) = (0, 0) $ m for all prisms.

Fig. \ref{fig:simple_map} shows that the estimated model obtained by using the true values for depth to the top $ z_0 $ and total-magnetization intensity $ m_0 $ (represented by the red triangle in Fig. \ref{fig:simple_map}) produces the lowest value of goal function  $ \Gamma(p) $ (eq. \ref{eq:gamma}). Fig. \ref{fig:simple_results}a shows that this estimated model (red prisms in Figs \ref{fig:simple_results}c and d) not only fits the noise-corrupted data, but also retrieves the geometry of the true model (blue prisms). The inset in Fig. \ref{fig:simple_results}a shows that the residuals follow a normal distribution with mean $ \mu $ and standard deviation $ \sigma $ compatible with those values used to generate 
the synthetic noise. The estimated thickness of each prism is $ dz = 297.65 $ m and  results in a maximum depth ($ 1485$ m) very close to the true one ($ 1600 $ m). 
These results illustrate the good performance of our method in an ideal case.

\subsection{Complex model test}

We have simulated a complex inclined body (blue prisms in Figs \ref{fig:complex_model} and \ref{fig:complex_result}), which extends from $z_0=-300$ m to $5700$ m along depth and violates most of the constraints described in subsection \ref{sec:constraints}. It is formed by $ L = 10 $ prisms, all of them with the same number of vertices $ V = 30 $ and thickness $ dz = 600 $ m. The horizontal coordinates of the origins $ O^k $ vary linearly from $ (x_0^0, y_0^0) = (-250, 750) $ m, at the shallowest prism, to $ (x_L^0, y_L^0) = (250, -750) $ m resulting a dip in the direction NW-SE, at the deepest prism. The radii $ r^k_j, k = 1, \dots, L$, $j = 1,\dots, V$, defining the vertices vary from $ 240 $ m to $ 1540 $ m and also differ from each other within the same prism. All prisms have a constant total magnetization with inclination $ -50^\circ $, declination $ 9^\circ $ and intensity $ m_0 = 12 $ A/m. This total magnetization is based on \cite{zhang-2018} which have estimated the total-magnetization vector for magnetic sources on the Goi√°s alkaline province (GAP). So, we are simulating an alkaline vertical dipping intrusion. We have calculated the total-field anomaly produced by this complex model on an $ 100 $ km$^2 $ area, simulating an airborne survey composed of 18 north-south flight lines distributed from $ -5000 $ m to $ 5000 $ m along the y axis and a east-west tie line approximately located at $ x = 0 $ m. The data points are located on the undulated surface shown in Fig. \ref{fig:complex_model}a. Notice that both flight and tie lines are not perfectly straight. We added a pseudorandom Gaussian noise having mean $ \mu_0$ nT and and standard deviation $ \sigma_0$ nT to the produced total-field anomaly(Fig. \ref{fig:simple_model}a).

Actually, they simulate the real survey presented in the following section. To compute the synthetic total-field anomaly, we consider a constant main field with inclination $ -21.5^\circ $ and declination $ -18.7^\circ $, which is significantly different from the total-magnetization direction of the complex model. Finally, we have
contaminated the synthetic total-field anomaly with a pseudorandom Gaussian noise having mean and standard deviation equal to $0$ nT and $5$ nT, respectively (Fig. \ref{fig:complex_model}a). We have inverted the synthetic total-field anomaly (Fig. \ref{fig:complex_model}a) produced by the complex model and to obtain 36 different models. Each model was obtained by using a specific pair of depth to the top $ z_0 $
and total-magnetization intensity $ m_0 $ (Fig. \ref{fig:complex_map}). Differently from the previous simulation with a simple model, the present grid of $ m_0 $ and $ z_0 $ does not contain the true values (represented by the red triangle in Fig. \ref{fig:complex_map}). All models were generated by using the true values of total-magnetization inclination and declination, the same interpretation model formed by $ L = 8 $ prisms, each one with $ V = 15 $ vertices, and the same weights for the constraining functions: $\tilde{\alpha}_1 = 10^{-5}$, $\tilde{\alpha}_2 = 10^{-4}$, $\tilde{\alpha}_3 = 10^{-4}$, $\tilde{\alpha}_4 = 0$, $\tilde{\alpha}_5 = 0$, $\tilde{\alpha}_6 = 10^{-7}$, and $\tilde{\alpha}_7 = 10^{-6}$. The initial approximation for all models have the same constant radii $ r^k_j = 800 $ m, $ k = 1, \dots, L $, $ j = 1, \dots, V $, the same thickness $ dz = 650 $ m and the same origin $ (x^k_0, y^k_0) = (-300, 300) $ m for all prisms.

Fig. \ref{fig:complex_map} shows that, compared to that shown in 
Fig. \ref{fig:simple_map}, the color map obtained for the complex model 
presents an elongated region containing candidate solutions, all of them 
producing small values for the goal function $ \Gamma(\mathbf{p}) $ (eq. \ref{eq:gamma}),
with different total-magnetization intensity $ m_0 $ and depth-to-the-top $z_0$. 
This result illustrates the inherent ambiguity of potential-field methods in 
retrieving both the physical-property distribution and volume of the sources. 
In this case, some a priori information must 
be used to constraint the range of reliable solutions.

The estimated model obtained by using the total-magnetization intensity $ m_0 = 11.4 $ A/m and depth-to-the-top $ z_0 = -320 $ m (represented by the cyan diamond in Fig. \ref{fig:complex_map}), close to the true values represented by the red
triangle in Fig. \ref{fig:complex_map}, produces the lowest value for the goal function 
$ \Gamma(\mathbf{p}) $ (eq. \ref{eq:gamma}). Fig. \ref{fig:complex_result} shows that this estimated model (red prisms in Figs \ref{fig:complex_result}c and d) fits the noise-corrupted data and also retrieves the geometry of the true source (blue prisms). 
Note that the red prisms edges accurately matches the blue prisms ones. 
The inset in Fig. \ref{fig:simple_results}a shows that the residuals follow a normal 
distribution with mean $ \mu $ and standard deviation $ \sigma $ compatible with those 
values used to generate the noise-corrupted data. 
The estimated maximum depth ($ 5597.7 $ m) and volume ($ 11.0 $ km$^3 $) are underestimated, but still close to the true values ($ 6000 $ m and $ 12.60 $ km$^3 $). 
These results show that our method can also be very useful to interpret complex sources, even if they do not perfectly satisfy the constraints imposed to solve the nonlinear inverse problem.